# Recom_SYSTEM

Рекомендательная система (ImplicitALS + LightGBM)

Входные данные:

- data - данные по продажам
- item_features - данные по товарам
- user_features - данные по покупателям
- test_data - тестовые данные по продажам для финального тестирования модели

Задача: построить рекомендательную систему по товарам.
Целевая метрика - money precision @ 5. Целевое значение - money precision @ 5 > 0.27%

Бизнес ограничения в топ-5 товарах:

Для каждого юзера 5 рекомендаций
2 новых товара (юзер никогда не покупал)
1 дорогой товар, > 7 долларов
Все товары из разных категорий (категория - sub_commodity_desc)
Стоимость каждого рекомендованного товара > 1 доллара
Выходной формат данных - .csv файл с рекомендациями. В .csv файле 2 столбца: user_id - (item_id1, item_id2, ..., item_id5)

Реализуем двухуровневую рекомендательную систему по схеме Implicit.ALS + LightGBM

Реализация (пайплайн):

- загружаем данные
- разбиваем на трейн/тесты в соответствии с 2 уровнями
- осуществляем предфильрацию
- обучаем рекоммендер первого уровня. при обучении используем tfidf-взвешивание, берем own_rec - прочие были отметены опытным путем
- готовим фичи для товаров:
- эмбеддинги
- цена
- среднее кол-во товара в корзине
- накопительная выручка по товару
- кол-во товаров в той же категории
- кол-во дней с последней продажи. если продаж за период не было, то берем кол-во дней в периоде и умножаем на 2 (типа вес)
- оставшиеся фичи преобразуем в категориальные
- готовим фичи для юзеров:
- эмбеддинги
- средний чек
- дней с последней покупки. если покупок за период не было, то берем кол-во дней в периоде и умножаем на 2 (типа вес)
- преобразуем возраст, средний доход, размер дома и кол-во детей в числовой формат
- оставшиеся фичи преобразуем в категориальные
- обучаем модель второго уровня. в качестве результата берем скор предикта.
- по скорам отбираем для юзера рекомендованные товары (100)
- по бизнес-требованиям из них отбираем по 5 товаров
- считаем метрику
- с помощью обученной модели считаем предикт для тестовых данных, считаем метрику.

## Что можно было бы еще:

- попробовать на первом уровне вместо бейзлайна использовать гибридную модель. первые попытки ощутимого результата не дали, поэтому было отложено.
- попробовать дополнительные фичи как для товаров и юзеров, так и для пар юзер-товар.
- попробовать gridsearch
- Попробовать иные лоссы
- пред-фильтровать данные для модели 2 уровня
- попробовать на втором уровне XGBoost или нейронку.
- выполнить более качественный рефакторинг - добавить функциональную обработку данных или вынести второй уровень в отдельный класс с написанием соответствующих методов
это все был отложено, так как полуенный результат в принципе пока устроил, а времени катастрофически не хватало.
